#include <iostream>
#include <Eigen/Core>

#include "SparseMatrix.h"
#include "SparseBlockMatrix.h"
#include "RHSVector.h"

int main(int argc, char const *argv[])
{

	sparse::SparseBlockMatrix<Eigen::Matrix2f> sp_block_mat(6,6,2);
	sparse::DenseVector<Eigen::Vector2f> rhs_B(6,2);
	Eigen::Matrix2f a;
	Eigen::Vector2f b;

	//! Setup the linear system (retarded fashion)
	a <<  16503,       15705,
			15705,       17585;
	sp_block_mat.setBlock(0,0,a);


	a <<  19151,       18586,
			21857,       21006;
	sp_block_mat.setBlock(0,2,a);
	sp_block_mat.setBlock(2,0,(Eigen::Matrix2f)a.transpose());

	a << 25501,       25188,
			25188,       27304;
	sp_block_mat.setBlock(1,1,a);

	a << 31269,       28686,
			28686,       27860;
	sp_block_mat.setBlock(2,2,a);

	a << 4096,         792,
			3432,         664;
	sp_block_mat.setBlock(3,1,a);
	sp_block_mat.setBlock(1,3,(Eigen::Matrix2f)a.transpose());

	a << 10014,        7328,
			4738,        1962;
	sp_block_mat.setBlock(4,1,a);
	sp_block_mat.setBlock(1,4,(Eigen::Matrix2f)a.transpose());

	a << 12157,        8748,
			8748,        6805;
	sp_block_mat.setBlock(3,3,a);

	a << 12288,        8548,
			11756,        8436;
	sp_block_mat.setBlock(4,3,a);
	sp_block_mat.setBlock(3,4,(Eigen::Matrix2f)a.transpose());

	a << 16398,       13365,
			13365,       12333;
	sp_block_mat.setBlock(4,4,a);

	a << 14618,        5977,
			5977,        2525;
	sp_block_mat.setBlock(5,5,a);





	//! RHS
	b << 		     3,
			10;
	rhs_B.setBlock(0, b);

	b << 			 2,
			 9;
	rhs_B.setBlock(1, b);

	b << 			 6,
			10;
	rhs_B.setBlock(2, b);

	b <<  			 1,
			 5;
	rhs_B.setBlock(3, b);

	b << 			 2,
			10;
	rhs_B.setBlock(4, b);

	b << 		1,
			8;
	rhs_B.setBlock(5, b);

	//! Solving linear system Ax = B
	sparse::DenseVector<Eigen::Vector2f> deltaX(6,2);
	sp_block_mat.solveLinearSystem(rhs_B, deltaX);

	cout << endl << BOLDGREEN << "Solution of the system:" << RESET <<  endl;
	deltaX.printVector();



	return 0;
}

