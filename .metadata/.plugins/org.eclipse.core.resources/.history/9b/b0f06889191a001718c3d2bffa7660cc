#include <iostream>
#include <Eigen/Core>

#include "SparseMatrix.h"
#include "SparseBlockMatrix.h"
#include "RHSVector.h"

typedef Eigen::Matrix<double, 6, 6> Matrix6d;
typedef Eigen::Matrix<double, 6, 1> Vector6d;


int main(int argc, char const *argv[])
{

   sparse::SparseBlockMatrix<Matrix6d> sp_block_mat(3,3,6);
   sparse::DenseVector<Vector6d> rhs_B(3,6);
   Matrix6d a;
   Vector6d b;

   //! Setup the linear system (retarded fashion)
   a <<    27.8696,   22.8569,   24.8197,   34.8410,   36.2142,   30.5505,
		   22.8569,   19.9057,   21.7136,   29.6531,   32.0041,   25.9854,
		   24.8197,   21.7136,   26.7212,   32.9307,   34.1144,   27.2616,
		   34.8410,   29.6531,   32.9307,   46.7531,   49.0366,   39.8087,
		   36.2142,   32.0041,   34.1144,   49.0366,   54.0662,   42.5354,
		   30.5505,   25.9854,   27.2616,   39.8087,   42.5354,   35.4130;
   sp_block_mat.setBlock(0,0,a);


   a <<    32.8933,   22.2498,   25.8874,   39.7095,   35.1891,   31.5753,
		   27.7699,   19.0347,   22.6605,   33.9140,   29.4038,   26.6163,
		   29.1110,   21.5228,   24.0822,   37.1343,   35.4727,   29.8805,
		   42.2014,   28.5580,   34.5380,   51.8856,   45.0937,   40.4579,
		   45.8703,   29.9982,   38.1193,   55.7156,   45.7940,   42.2863,
		   37.2074,   24.9659,   29.8588,   45.0217,   38.1453,   35.4263;
   sp_block_mat.setBlock(0,2,a);

   a <<	   36.8810,   19.2071,   33.8579,   17.3176,   24.8227,   23.6578,
		   19.2071,   10.1215,   17.6601,    8.8956,   13.0553,   12.4372,
		   33.8579,   17.6601,   31.3619,   15.7559,   22.6739,   21.7014,
		   17.3176,    8.8956,   15.7559,    8.4885,   11.6349,   10.8468,
		   24.8227,   13.0553,   22.6739,   11.6349,   16.9376,   16.0285,
		   23.6578,   12.4372,   21.7014,   10.8468,   16.0285,   15.4476;
   sp_block_mat.setBlock(1,1,a);

   a <<    32.8933,   27.7699,   29.1110,   42.2014,   45.8703,   37.2074,
		   22.2498,   19.0347,   21.5228,   28.5580,   29.9982,   24.9659,
		   25.8874,   22.6605,   24.0822,   34.5380,   38.1193,   29.8588,
		   39.7095,   33.9140,   37.1343,   51.8856,   55.7156,   45.0217,
		   35.1891,   29.4038,   35.4727,   45.0937,   45.7940,   38.1453,
		   31.5753,   26.6163,   29.8805,   40.4579,   42.2863,   35.4263;
   sp_block_mat.setBlock(2,0,a);

   a <<    44.9104,   28.4207,   36.3203,   53.1145,   44.1841,   40.6208,
		   28.4207,   20.4720,   22.3956,   34.9557,   31.5703,   28.3389,
		   36.3203,   22.3956,   30.8044,   43.4743,   35.5272,   32.3244,
		   53.1145,   34.9557,   43.4743,   65.7854,   55.8895,   50.4359,
		   44.1841,   31.5703,   35.5272,   55.8895,   53.5615,   45.3197,
		   40.6208,   28.3389,   32.3244,   50.4359,   45.3197,   40.4025;
   sp_block_mat.setBlock(2,2,a);

   //! RHS
   b <<     0.7932,
		   -0.8984,
		    0.1562,
		    1.5973,
		    0.1124,
		   -0.3086;
   rhs_B.setBlock(0, b);

   b << 	0.4567,
		   -0.2751,
		    0.4431,
		   -0.1348,
		   -0.0183,
		    0.4608;
   rhs_B.setBlock(1, b);

   b <<     1.3623,
		    0.4519,
		    1.6484,
		   -2.0284,
		   -0.4493,
		    0.2360;
   rhs_B.setBlock(2, b);

   //! Solving linear system Ax = B
   sparse::DenseVector<Vector6d> deltaX(3,6);
   sp_block_mat.solveLinearSystem(rhs_B, deltaX);

   cout << endl << BOLDGREEN << "Solution of the system:" << RESET <<  endl;
   deltaX.printVector();



   return 0;
}

