#include <iostream>
#include <Eigen/Core>

#include "SparseMatrix.h"
#include "SparseBlockMatrix.h"
#include "RHSVector.h"

int main(int argc, char const *argv[])
{

	/*
	 A:
	1.1512    0.7703         0         0    0.5153    0.9971         0         0         0         0         0         0
    0.7703    1.0264         0         0    0.4891    1.0538         0         0         0         0         0         0
         0         0    0.1610    0.1069         0         0    0.0156    0.0134    0.1034    0.0847         0         0
         0         0    0.1069    0.0762         0         0    0.0138    0.0118    0.0650    0.0528         0         0
    0.5153    0.4891         0         0    0.3577    0.7335         0         0         0         0         0         0
    0.9971    1.0538         0         0    0.7335    1.5455         0         0         0         0         0         0
         0         0    0.0156    0.0138         0         0    0.5677    0.2772    0.0537    0.0450         0         0
         0         0    0.0134    0.0118         0         0    0.2772    0.1359    0.0287    0.0238         0         0
         0         0    0.1034    0.0650         0         0    0.0537    0.0287    0.0758    0.0644         0         0
         0         0    0.0847    0.0528         0         0    0.0450    0.0238    0.0644    0.0558         0         0
         0         0         0         0         0         0         0         0         0         0    1.9507    1.6014
         0         0         0         0         0         0         0         0         0         0    1.6014    1.4479


		 B;

	   -0.0460
	   -0.4657
		0.0759
	   -0.9188
	   -1.9195
	   -0.0364
	   -1.2251
	   -1.9024
		2.3742
	   -0.2333
		0.4039
		1.1925
	 */

	sparse::SparseBlockMatrix<Eigen::Matrix2f> sp_block_mat(6,6,2);
	sparse::DenseVector<Eigen::Vector2f> rhs_B(6,2);
	Eigen::Matrix2f a;
	Eigen::Vector2f b;

	//! Setup the linear system (retarded fashion)
	a <<  1.1512, 0.7703,
			0.7703, 1.0264;
	sp_block_mat.setBlock(0,0,a);


	a <<  0.5153, 0.4891,
			0.9971, 1.0538;
	sp_block_mat.setBlock(0,2,a);

	a <<	 0.1610, 0.1069,
			0.1069, 0.0762;
	sp_block_mat.setBlock(1,1,a);

	a << 0.5153, 0.9971,
			0.4891, 1.0538;
	sp_block_mat.setBlock(2,0,a);

	a << 0.3577, 0.7335,
			0.7335, 1.5455;
	sp_block_mat.setBlock(2,2,a);

	a << 0.0156,    0.0138,
			0.0134,    0.0118;
	sp_block_mat.setBlock(1,3,a);

	a << 0.0156,    0.0134,
			0.0138,    0.0118;
	sp_block_mat.setBlock(3,1,a);

	a << 0.1034,    0.0650,
			0.0847,    0.0528;
	sp_block_mat.setBlock(5,2,a);

	a << 0.1034,    0.0847,
			0.0650,    0.0528;
	sp_block_mat.setBlock(2,5,a);

	a << 0.5677,    0.2772,
			0.2772,    0.1359;
	sp_block_mat.setBlock(3,3,a);

	a << 0.0537,    0.0450,
			0.0287,    0.0238;
	sp_block_mat.setBlock(3,4,a);

	a << 0.0537,    0.0287,
			0.0450,    0.0238;
	sp_block_mat.setBlock(4,3,a);

	a << 0.0758,    0.0644,
			0.0644,    0.0558;
	sp_block_mat.setBlock(4,4,a);

	a << 1.9507,    1.6014,
			1.6014,    1.4479;
	sp_block_mat.setBlock(5,5,a);





	//! RHS
	b << -0.0460,
	-0.4657;
	rhs_B.setBlock(0, b);

	b << 		0.0759,
			-0.9188;
	rhs_B.setBlock(1, b);

	b <<  	   -1.9195,
			-0.0364;
	rhs_B.setBlock(2, b);

	b <<  	   -1.2251,
			-1.9024;
	rhs_B.setBlock(3, b);

	b <<  		2.3742,
			-0.2333;
	rhs_B.setBlock(4, b);

	b << 		0.4039,
			1.1925;
	rhs_B.setBlock(5, b);

	//! Solving linear system Ax = B
	sparse::DenseVector<Eigen::Vector2f> deltaX(6,2);
	sp_block_mat.solveLinearSystem(rhs_B, deltaX);

	cout << endl << BOLDGREEN << "Solution of the system:" << RESET <<  endl;
	deltaX.printVector();



	return 0;
}

